<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
	<link rel="stylesheet" href="style.css">
	<title>Weather Dashboard</title>
</head>

<body>
	<h1>Weather Dashboard</h1>
	<div class="col-4" id="nav">
		<h6>Search for a City:</h6>
		<div class="input-group mb-3">
			<input id="input-city" type="text" class="form-control" aria-label="Search City"
				aria-describedby="button-addon2">
			<div class="input-group-append">
				<button id="search-city" type="button" class="btn btn-primary"><i class="fas fa-search"></i></button>
			</div>
		</div>
		<div>
			<nav>
				<ul class="list-group" id="list-cities">
					<li class="location">Cras justo odio</li>
				</ul>
			</nav>
		</div>
	</div>
	<div id="info">
		<div class="container" id="forecastNow">
		</div>
		<div id="forecast5Day">
			<h4>5-Day Forecast:</h4>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Card title</h5>
					<h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
					<p class="card-text">Some quick example text to build on the card title and make up the bulk of the
						card's content.</p>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">
		// Array of weather locations
		var weatherLocations = ["Austin", "Chicago", "New York", "Orlando", "San Francisco", "Seattle", "Denver", "Atlanta"];


		function displayWeather(location) {
			// API Key for OpenWeather API
			// Create AJAX call 
			$.ajax({
				url: "http://api.openweathermap.org/data/2.5/weather?q=" + location + "&units=imperial&appid=a1c038ee051fba2c57aa5df3e76e9156",
				method: "GET"
			}).then(function (response) {
				console.log(response);
				

				// Creating element to hold forecast
				var forecast = $("<div class='forecast'>");

				// Create, Display and Retrieve Name
				var name = response.name;
				var date = moment().format('l');
				var icon = response.weather[0].icon;
				var iconIMG = $("<img src=" + 'http://openweathermap.org/img/wn/' + icon + '.png' + ">");
				console.log(iconIMG);

				var info1 = $("<p>").text(name + " " + date).append(iconIMG);

				// Create, Display and Retrieve Temperature
				var temperature = response.main.temp;
				var info2 = $("<p>").text("Temperature: " + temperature + "Â°F");

				// Create, Display and Retrieve Humidity
				var humidity = response.main.humidity;
				var info3 = $("<p>").text("Humidity: " + humidity + "%");

				// Create, Display and Retrieve Wind Speed
				var wind = response.wind.speed;
				var info4 = $("<p>").text("Wind Speed: " + wind + " MPH");

				// Append Forecast Info
				$("#forecastNow").append(info1, info2, info3, info4);
			});
		};

		// Function for displaying movie data
		function renderButtons() {

			// Deleting the movies prior to adding new movies
			// (this is necessary otherwise you will have repeat buttons)
			$("#list-cities").empty();

			// Looping through the array of locations
			for (var i = 0; i < weatherLocations.length; i++) {

				// Then dynamicaly generating buttons for each location in the array
				var a = $("<li id='location'>");
				// Adding a class
				a.addClass("list-group-item");
				// Adding a data-attribute
				a.attr("data-name", weatherLocations[i]);
				// Providing the initial button text
				a.text(weatherLocations[i]);
				// Adding the button to the div
				$("#list-cities").append(a);
			}
		}



		// Event handler to get city name
		$("#search-city").on("click", function (event) {
			event.preventDefault();

			// Store name of city
			var city = $("#input-city").val().trim();
			console.log(city);

			// City pushed to array
			weatherLocations.push(city);

			// Run displayWeather function(passing city as argement)
			displayWeather(city);

			renderButtons(city);
		});

		// Adding click event listeners to all elements with a class of "movie"
		$(document).on("click", ".movie", displayWeather);

		renderButtons();

	</script>


</body>

</html>